'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var fragment = "precision highp float;\r\nin vec2 vTextureCoord;\r\nout vec4 finalColor;\r\n\r\nuniform sampler2D uTexture;\r\nuniform float uRadian;\r\nuniform vec2 uCenter;\r\nuniform float uRadius;\r\nuniform int uKernelSize;\r\n\r\nuniform vec4 uInputSize;\r\n\r\nconst int MAX_KERNEL_SIZE = 2048;\r\n\r\nvoid main(void)\r\n{\r\n    vec4 color = texture(uTexture, vTextureCoord);\r\n\r\n    if (uKernelSize == 0)\r\n    {\r\n        finalColor = color;\r\n        return;\r\n    }\r\n\r\n    float aspect = uInputSize.y / uInputSize.x;\r\n    vec2 center = uCenter.xy / uInputSize.xy;\r\n    float gradient = uRadius / uInputSize.x * 0.3;\r\n    float radius = uRadius / uInputSize.x - gradient * 0.5;\r\n    int k = uKernelSize - 1;\r\n\r\n    vec2 coord = vTextureCoord;\r\n    vec2 dir = vec2(center - coord);\r\n    float dist = length(vec2(dir.x, dir.y * aspect));\r\n\r\n    float radianStep = uRadian;\r\n    if (radius >= 0.0 && dist > radius) {\r\n        float delta = dist - radius;\r\n        float gap = gradient;\r\n        float scale = 1.0 - abs(delta / gap);\r\n        if (scale <= 0.0) {\r\n            finalColor = color;\r\n            return;\r\n        }\r\n        radianStep *= scale;\r\n    }\r\n    radianStep /= float(k);\r\n\r\n    float s = sin(radianStep);\r\n    float c = cos(radianStep);\r\n    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));\r\n\r\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\r\n        if (i == k) {\r\n            break;\r\n        }\r\n\r\n        coord -= center;\r\n        coord.y *= aspect;\r\n        coord = rotationMatrix * coord;\r\n        coord.y /= aspect;\r\n        coord += center;\r\n\r\n        vec4 sample = texture(uTexture, coord);\r\n\r\n        // switch to pre-multiplied alpha to correctly blur transparent images\r\n        // sample.rgb *= sample.a;\r\n\r\n        color += sample;\r\n    }\r\n\r\n    finalColor = color / float(uKernelSize);\r\n}\r\n";

exports["default"] = fragment;
//# sourceMappingURL=radial-blur.js.map
